
@{
    ViewData["Title"] = "Index";
}
@model IPResolver.Controllers.ViewController.ViewModel
<script src="~/js/signalr-client-1.0.0-alpha2-final.min.js"></script>
<script>
    let hubUrl = window.location.origin + '/indexhub';
    let httpConnection = new signalR.HttpConnection(hubUrl);
    let hubConnection = new signalR.HubConnection(httpConnection);

    hubConnection.on("newClient", function (data) {
        var row = document.createElement("tr");
        var name = document.createElement("td")
        name.innerText = data;
        var status = document.createElement("td")
        status.innerText = "True";
        var connectionTime = document.createElement("td")
        connectionTime.innerText = "MOCK";
        row.appendChild(name);
        row.appendChild(status);
        row.appendChild(connectionTime);
        document.getElementById("clientsTable")
            .appendChild(row);
    });

    let f = function(message) {
        hubConnection.invoke("Some", message);
    }

    hubConnection.start();
</script>
<h1>TEST HEADER</h1>
<h1>CCF Status</h1>
<h2>Services</h2>
<table>
    <tr>
        <th>InterfaceName</th>
        <th>Status</th>
        <th>Connection time ago</th>
        <th>last ping ago</th>
        <th>last ping time</th>


		
    </tr>
    @foreach(var service in Model.Services)
    {
        <tr>
            <th>@service.InterfaceName</th>
            <th>@service.Connection.Connected</th>
            <th>@(DateTime.Now - service.ConnectionTime)</th>
            <th>@(DateTime.Now - service.LastPing)</th>
            <th>@(service.PingTime)</th>
        </tr>
    }
</table>
<h2>Clients</h2>
<table id="clientsTable">
    <tr>
        <th>InterfaceName</th>
        <th>Status</th>
        <th>Connection time ago</th>
        <th>last ping ago</th>
        <th>last ping time</th>

    </tr>
    @foreach (var client in Model.Users)
    {
        <tr>
            <th>@client?.InterfaceName</th>
            <th>@client?.Connection.Connected</th>
            <th>@(DateTime.Now - client?.ConnectionTime)</th>
            <th>@(DateTime.Now - client?.LastPing)</th>
            <th>@(client?.PingTime)</th>
        </tr>
    }
</table>